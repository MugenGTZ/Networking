/*//////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
WARNING: The Encryption is very weak!, the Checksum is also not appropriate!
WARNING: Only use this library for testing purpose!
WARNING: This library is slow!
////////////////////////////////////////////////////////////////////////////////////////
*///////////////////////////////////////////////////////////////////////////////////////
#include <string.h>

//#pragma GCC diagnostic warning "ENCRYPTION LIBRARY IS NOT SECURE!"
#define CHECKSUMLENGTH 32
/*//////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
Function prototypes
////////////////////////////////////////////////////////////////////////////////////////
*///////////////////////////////////////////////////////////////////////////////////////
void	netEncryptSymmetric(char *key, char *data, int len, char *output);
void	netDecryptSymmetric(char *key, char *data, int len, char *output);
void	netCheckSum(unsigned char *data, int len, unsigned char output[CHECKSUMLENGTH]);
int		netAreCheckSumsEqual(char sum1[CHECKSUMLENGTH], char sum2[CHECKSUMLENGTH]);
//--------------------------------------------------------------------------------------
char key2char(char *key);
/*//////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
Main functions
////////////////////////////////////////////////////////////////////////////////////////
*///////////////////////////////////////////////////////////////////////////////////////
//Symmetric encryption
void	netEncryptSymmetric(char *key, char *data, int len, char *output){
	char keyChar = key2char(key);
	for(int i=0; i < len; i++) output[i] = data[i]^keyChar;
}
void	netDecryptSymmetric(char *key, char *data, int len, char *output){
	netEncryptSymmetric(key, data, len, output);
}

//Check sum
void	netCheckSum(char *data, int len, char output[CHECKSUMLENGTH]){
	char outputChar = 0;
	for(int i=0; i < len; i++) outputChar ^= data[i];
	output[0] = outputChar;
}
int		netAreCheckSumsEqual(char sum1[CHECKSUMLENGTH], char sum2[CHECKSUMLENGTH]){
	if(sum1[0] == sum2[0]) 	return 1;
	else					return 0;
}

/*//////////////////////////////////////////////////////////////////////////////////////
////////////////////////////////////////////////////////////////////////////////////////
Helper functions
////////////////////////////////////////////////////////////////////////////////////////
*///////////////////////////////////////////////////////////////////////////////////////

char key2char(char *key){
	char outputChar = 0;
	for(unsigned int i=0; i<strlen(key);i++){
		outputChar ^= key[i];
	}
	return outputChar;
}

